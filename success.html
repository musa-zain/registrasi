<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Pendaftaran Berhasil</title>

<style>
body{margin:0;font-family:system-ui;background:#fff;color:#1f2937;text-align:center}
main{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px}
.card{max-width:460px;width:100%;border:1px solid #e5e7eb;border-radius:16px;padding:26px}
.info{background:#f9fafb;padding:16px;border-radius:12px;text-align:left}
.qr{margin:20px auto;width:200px}
button,a{padding:12px;border-radius:10px;font-weight:600}
button{background:#047857;color:#fff;border:none}
a{text-decoration:none;border:1px solid #a7f3d0;color:#047857}
</style>
</head>

<body>
<main>
<div class="card">
  <h2>✅ Registration Successful</h2>

  <div class="info">
    <p><b>ID:</b> <span id="id"></span></p>
    <p><b>Nama:</b> <span id="nama"></span></p>
    <p><b>Email:</b> <span id="email"></span></p>
    <p><b>No HP:</b> <span id="hp"></span></p>
    <p><b>Domisili:</b> <span id="dom"></span></p>
    <p><b>Usia:</b> <span id="usia"></span></p>
    <p><b>Jenis Kelamin:</b> <span id="jk"></span></p>
    <p><b>Jumlah:</b> <span id="jml"></span></p>
  </div>

  <div class="qr" id="qrBox"></div>

  <button onclick="downloadQR()" id="btn">⬇️ Download QR</button><br><br>
  <a href="index.html">Kembali</a>
</div>
</main>

<script>
const p = new URLSearchParams(location.search);
const g = k=>p.get(k)||"-";

id.textContent=g("id");
nama.textContent=g("nama_lengkap");
email.textContent=g("email");
hp.textContent=g("no_hp");
dom.textContent=g("domisili");
usia.textContent=g("usia");
jk.textContent=g("jk");
jml.textContent=g("jumlah_orang");

const qrURL=`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(g("id"))}`;
qrBox.innerHTML=`<img src="${qrURL}" id="qrImg">`;

function safe(n){return n.replace(/[^a-z0-9]/gi,"_").toLowerCase();}

async function downloadQR(){
  btn.textContent="...";
  const b=await fetch(qrURL).then(r=>r.blob());
  const u=URL.createObjectURL(b);
  const a=document.createElement("a");
  a.href=u;
  a.download=`QR_${safe(g("nama_lengkap"))}_${g("id")}.png`;
  a.click();
  URL.revokeObjectURL(u);
  btn.textContent="✅ Tersimpan";
}
</script>
</body>
</html>
