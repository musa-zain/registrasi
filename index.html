<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Pendaftaran Sholat Idul Fitri</title>

    <style>
        * { box-sizing: border-box; }
        body {
            min-height: 100vh;
            margin: 0;
            display: flex;
            flex-direction: column;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            font-size: 15px;
            line-height: 1.6;
            color: #1f2937;
            background-color: #f8fafc;
        }
        main { flex: 1; padding: 32px 16px; }
        .container { max-width: 460px; margin: 0 auto; }
        .header { text-align: center; margin-bottom: 18px; position: relative; padding-top: 12px; }
        .header::after {
            content: ""; display: block; width: 80px; height: 2px; margin: 10px auto 0;
            background: linear-gradient(to right, transparent, #047857, transparent);
            opacity: 0.35;
        }
        .header h1 { font-size: 22px; margin-bottom: 2px; color: #065f46; font-weight: 700; }
        .masjid-name { font-size: 17px; font-weight: 600; color: #065f46; margin-top: 2px; letter-spacing: 0.6px; }
        .card { background-color: #ffffff; border-radius: 14px; padding: 24px 20px; border: 1px solid #e5e7eb; position: relative; }
        .field { margin-bottom: 18px; }
        label { display: block; font-weight: 500; margin-bottom: 6px; color: #374151; }
        input[type="text"], input[type="email"], input[type="number"], input[type="tel"], textarea {
            width: 100%; padding: 11px 12px; height: 44px; font-size: 15px; font-family: inherit;
            border: 1px solid #d1d5db; border-radius: 8px; transition: border-color 0.15s, box-shadow 0.15s;
        }
        input:focus, textarea:focus { outline: none; border-color: #047857; box-shadow: 0 0 0 3px #d1fae5; }
        .radio-group label, .checkbox label { font-weight: 400; display: flex; align-items: center; gap: 8px; margin-bottom: 6px; }
        button {
            width: 100%; padding: 13px; font-size: 15px; font-weight: 500;
            background-color: #047857; color: #ffffff; border: none; border-radius: 10px; cursor: pointer;
        }
        button:disabled { background-color: #9ca3af; cursor: not-allowed; }
        footer { text-align: center; padding: 18px 10px; font-size: 12px; color: #6b7280; background-color: #ecfdf5; }
    </style>
</head>

<body>

<main>
<div class="container">
    <div class="header">
        <h1 data-id="Form Pendaftaran Sholat Idul Fitri" data-ja="イドゥル・フィトリ礼拝 参加登録フォーム" data-en="Eid al-Fitr Prayer Registration Form"></h1>
        <div class="masjid-name" data-id="Masjid Central Okayama" data-ja="岡山セントラルモスク" data-en="Okayama Central Mosque"></div>
    </div>

    <div class="card">
        <form id="registrationForm">
            <div class="field">
                <label data-id="Nama Lengkap" data-ja="氏名" data-en="Full Name"></label>
                <input type="text" name="nama_lengkap" required>
            </div>

            <div class="field">
                <label data-id="Email" data-ja="メールアドレス" data-en="Email"></label>
                <input type="email" name="email" required>
            </div>

            <div class="field">
                <label data-id="Domisili / Kota" data-ja="居住地" data-en="City"></label>
                <textarea name="domisili" required></textarea>
            </div>

            <div class="field">
                <label data-id="Nomor HP / WhatsApp" data-ja="電話番号" data-en="Phone Number"></label>
                <input type="tel" name="no_hp" inputmode="numeric" pattern="[0-9]{10,13}" required>
            </div>

            <div class="field">
                <label data-id="Usia" data-ja="年齢" data-en="Age"></label>
                <input type="number" name="usia" required>
            </div>

            <div class="field radio-group">
                <label data-id="Jenis Kelamin" data-ja="性別" data-en="Gender"></label>
                <label><input type="radio" name="jk" value="Laki-laki" required><span data-id="Laki-laki" data-ja="男性" data-en="Male"></span></label>
                <label><input type="radio" name="jk" value="Perempuan"><span data-id="Perempuan" data-ja="女性" data-en="Female"></span></label>
            </div>

            <div class="field checkbox">
                <label>
                    <input type="checkbox" name="setuju" required>
                    <span data-id="Saya menyetujui data digunakan untuk keperluan acara ini" data-ja="本イベントの目的で個人情報を使用することに同意します" data-en="I agree that my data may be used for this event"></span>
                </label>
            </div>

            <button type="submit" id="submitBtn" data-id="Daftar" data-ja="登録" data-en="Register"></button>
        </form>
    </div>
</div>
</main>

<footer>© 2025 — Yayasan Ibadurrahman Islamic Center</footer>

<script>
// --- KONFIGURASI ---
// Masukkan URL Web App dari Google Apps Script yang sudah di-deploy
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzRLXjI2gQS55U3oiyR_6znbhLyptaVG5QmL-VjjqJUKVyvSsP5M6iyJhkSfM9FoaS3/exec";

// --- LOGIKA BAHASA ---
(function () {
    const lang = (navigator.languages && navigator.languages[0]) || navigator.language || "id";
    let current = "id";
    if (lang.startsWith("ja")) current = "ja";
    else if (lang.startsWith("en")) current = "en";

    document.querySelectorAll("[data-id]").forEach(el => {
        el.textContent = el.dataset[current] || el.dataset.id;
    });
})();

// --- LOGIKA PENGIRIMAN DATA ---
document.getElementById('registrationForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const submitBtn = document.getElementById('submitBtn');
    submitBtn.disabled = true;
    submitBtn.innerText = "Processing...";

    const formData = new FormData(this);
    // Tambahkan parameter action agar script backend tahu ini proses registrasi
    formData.append("action", "register");

    fetch(SCRIPT_URL, {
        method: 'POST',
        body: formData
    })
    .then(response => response.json())
    .then(result => {
        if (result.status === 'success') {
            // Arahkan ke success.html dengan membawa ID dan data input
            const queryParams = new URLSearchParams(result.data).toString();
            window.location.href = `success.html?id=${result.id}&${queryParams}`;
        } else {
            alert("Terjadi kesalahan saat mendaftar. Silakan coba lagi.");
            submitBtn.disabled = false;
            submitBtn.innerText = "Daftar";
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert("Gagal terhubung ke server.");
        submitBtn.disabled = false;
        submitBtn.innerText = "Daftar";
    });
});
</script>

</body>
</html>
